<!DOCTYPE html>
<html>
<head>
	<title>Регистрация</title>
	<script src="https://www.gstatic.com/firebasejs/9.0.1/firebase-app.js"></script>
	<script src="https://www.gstatic.com/firebasejs/9.0.1/firebase-auth.js"></script>
	<script>
		// Инициализируем Firebase
		const firebaseConfig = {
			apiKey: "YOUR_API_KEY",
			authDomain: "YOUR_AUTH_DOMAIN",
			projectId: "YOUR_PROJECT_ID",
			storageBucket: "YOUR_STORAGE_BUCKET",
			messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
			appId: "YOUR_APP_ID"
		};
		firebase.initializeApp(firebaseConfig);

		// Получаем ссылку на коллекцию пользователей
		const usersCollection = firebase.firestore().collection('users');

		// Обрабатываем данные формы регистрации
		const registerForm = document.querySelector('#register-form');
		registerForm.addEventListener('submit', (e) => {
			e.preventDefault();
			const username = registerForm['username'].value;
			const email = registerForm['email'].value;
			const password = registerForm['password'].value;
			const confirmPassword = registerForm['confirm-password'].value;

			if (password !== confirmPassword) {
				alert("Пароли не совпадают");
				return;
			}

			// Создаем нового пользователя
			firebase.auth().createUserWithEmailAndPassword(email, password)
				.then((userCredential) => {
					// Добавляем информацию о пользователе в коллекцию Firestore
					const newUser = {
						uid: userCredential.user.uid,
						username: username,
						email: email
					};
					usersCollection.doc(newUser.uid).set(newUser)
						.then(() => {
							alert("Пользователь зарегистрирован успешно");
							registerForm.reset();
						})
						.catch((error) => {
							alert("Ошибка: " + error.message);
						});
				})
				.catch((error) => {
					alert("Ошибка: " + error.message);
				});
		});
	</script>
</head>
<body>
	<h1>Регистрация</h1>
	<form id="register-form">
		<label for="username">Имя пользователя:</label>
		<input type="text"id="username" name="username" required>
		<label for="email">Email:</label>
		<input type="email" id="email" name="email" required>
		<label for="password">Пароль:</label>
		<input type="password" id="password" name="password" required>
		<label for="confirm-password">Подтвердите пароль:</label>
		<input type="password" id="confirm-password" name="confirm-password" required>
		<button type="submit">Зарегистрироваться</button>
	</form>
</body>
</html>
